# @typeglot/cli

TypeGlot CLI - command-line interface for type-safe internationalization.

## Installation

```bash
npm install -D @typeglot/cli
# or use with npx (no installation required)
npx @typeglot/cli init
```

> **Note:** TypeGlot is a **dev dependency only**. The generated code has **zero runtime dependencies** â€” nothing from `@typeglot/*` is bundled into your production app.

## What `typeglot init` Creates

Running `typeglot init` creates the following files:

```
your-project/
â”œâ”€â”€ typeglot.config.json     # Configuration file
â”œâ”€â”€ locales/                  # Translation source files
â”‚   â””â”€â”€ en.json              # Source locale (committed to git)
â””â”€â”€ src/generated/i18n/      # Generated TypeScript (gitignored)
    â”œâ”€â”€ index.ts             # Main exports + locale types
    â”œâ”€â”€ messages.ts          # Typed translation functions
    â”œâ”€â”€ en.ts                # English messages as const
    â””â”€â”€ es.ts                # Spanish messages as const (etc.)
```

### Files Explained

| File                   | Commit to Git?    | Bundled in Production? | Description                    |
| ---------------------- | ----------------- | ---------------------- | ------------------------------ |
| `typeglot.config.json` | âœ… Yes            | âŒ No                  | Configuration for the compiler |
| `locales/*.json`       | âœ… Yes            | âŒ No                  | Source translation files       |
| `src/generated/i18n/*` | âŒ No (gitignore) | âœ… Yes                 | Generated TypeScript code      |

### What Gets Bundled

**Only the generated TypeScript files** are bundled in your production app. The generated code is:

- **Self-contained** â€” No imports from `@typeglot/*` packages
- **Zero runtime dependencies** â€” Pure TypeScript with no external libraries
- **Tree-shakeable** â€” Unused translations can be removed by bundlers

The JSON files are **not** bundled â€” they're compiled into TypeScript at build time.

### Recommended `.gitignore`

Add the generated output directory to your `.gitignore`:

```gitignore
# TypeGlot generated files (regenerated on build)
src/generated/i18n/
```

The generated files should be regenerated by running `typeglot build` in your CI/CD pipeline or build process.

## Usage

### Initialize a new project

```bash
typeglot init
```

The init command is smart and will:

- **Detect existing locale files** in common locations (`locales/`, `src/locales/`, `src/i18n/`, etc.)
- **Detect monorepos** (pnpm workspaces, npm/yarn workspaces) and let you choose which packages to initialize
- **Ask which locale is your source** if multiple locales are found

#### Monorepo Support

In a monorepo, you'll be prompted to choose:

```
ğŸŒ Initializing TypeGlot...

ğŸ“¦ Detected monorepo with packages:

? Where would you like to initialize TypeGlot?
  â¯ Root (shared translations)
    Specific packages

? Select packages to initialize:
  â—¯ @myapp/frontend
  â—¯ @myapp/backend
```

#### Existing Projects

If you already have translation files:

```
ğŸ“‚ Found existing locale files in src/locales/
   Locales: en, es, de

? Use existing locales directory (src/locales/)? Yes
? Which locale is your source (primary) locale? en
```

### Development mode with live compilation

```bash
typeglot dev
```

Watches for changes and recompiles automatically. Also starts a local dashboard at `http://localhost:3333`.

### Build translations

```bash
typeglot build
```

Compiles all JSON translation files to TypeScript. Run this in CI/CD before your main build.

### Translate missing keys with AI

```bash
typeglot translate
```

Uses AI to translate missing keys to target locales.

## Generated Code Example

Given this `locales/en.json`:

```json
{
  "hello": "Hello",
  "welcome": "Welcome, {name}!"
}
```

TypeGlot generates:

```typescript
// src/generated/i18n/messages.ts (auto-generated)
export function hello(): string {
  return messages['hello'] ?? `Hello`;
}

export function welcome(params: { name: string }): string {
  const template = messages['welcome'] ?? `Welcome, {name}!`;
  return formatMessage(template, params);
}

export const m = { hello, welcome } as const;
```

Use in your code:

```typescript
import { m } from './generated/i18n';

m.hello(); // "Hello"
m.welcome({ name: 'Alice' }); // "Welcome, Alice!"
```

## Features

- ğŸš€ Fast TypeScript compilation of translation files
- ğŸ”„ Live reload in development mode
- ğŸ¤– AI-powered translation with GitHub Copilot
- ğŸ“Š Translation dashboard UI
- âœ… Full type safety with autocomplete
- ğŸ“¦ Monorepo support with interactive package selection
- ğŸ” Auto-detection of existing locale files
- ğŸª¶ Zero runtime dependencies in production

## Documentation

For complete documentation, visit [typeglot.ahlstrand.es](https://typeglot.ahlstrand.es)

## License

MIT
